!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("graphology"),require("neo4j-driver")):"function"==typeof define&&define.amd?define(["graphology","neo4j-driver"],t):"object"==typeof exports?exports["graphology-neo4j"]=t(require("graphology"),require("neo4j-driver")):e["graphology-neo4j"]=t(e.graphology,e["neo4j-driver"])}(this,(function(e,t){return(()=>{"use strict";var r=[,function(e,t,r){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.cypherToGraph=void 0;const n=o(r(2)),i=r(3);function s(e,t,r){if(function(e){let t=!1;e&&Object.prototype.hasOwnProperty.call(e,"identity")&&Object.prototype.hasOwnProperty.call(e,"identity")&&Object.prototype.hasOwnProperty.call(e,"labels")&&(t=!0);return t}(e))c(e,t,r);else if(function(e){let t=!1;e&&Object.prototype.hasOwnProperty.call(e,"identity")&&Object.prototype.hasOwnProperty.call(e,"type")&&Object.prototype.hasOwnProperty.call(e,"start")&&Object.prototype.hasOwnProperty.call(e,"end")&&(t=!0);return t}(e))a(e,t,r);else if(function(e){let t=!1;e&&Object.prototype.hasOwnProperty.call(e,"start")&&Object.prototype.hasOwnProperty.call(e,"end")&&Object.prototype.hasOwnProperty.call(e,"segments")&&(t=!0);return t}(e)){const o=e;c(o.start,t,r),o.segments.forEach((e=>{c(e.start,t,r),a(e.relationship,t,r),c(e.end,t,r)}))}else Array.isArray(e)?e.forEach((e=>{s(e,t,r)})):"[object Object]"===Object.prototype.toString.call(e)&&Object.keys(e).forEach((o=>{s(e[o],t,r)}))}function c(e,t,r){const o=Object.assign(Object.assign({},e.properties),{[r.id]:e.identity.toString(),[r.labels]:e.labels});t.mergeNode(e.identity.toString(),o)}function a(e,t,r){const o=Object.assign(Object.assign({},e.properties),{[r.id]:e.identity.toString(),[r.type]:e.type});t.mergeEdgeWithKey(e.identity.toString(),`${e.start}`,`${e.end}`,o)}t.cypherToGraph=function(e,t,r={},o={id:"@id",labels:"@labels",type:"@type"}){return new Promise(((c,a)=>{const p=new n.default({multi:!0,type:"directed",allowSelfLoops:!0}),l=e.driver.session({defaultAccessMode:i.session.READ,database:e.database});l.run(t,r).subscribe({onNext:e=>{e.forEach((e=>{try{s(e,p,o)}catch(e){a(e)}}))},onCompleted:()=>{l.close(),c(p)},onError:e=>{l.close(),a(e)}})}))}},t=>{t.exports=e},e=>{e.exports=t},function(e,t,r){var o=this&&this.__awaiter||function(e,t,r,o){return new(r||(r=Promise))((function(n,i){function s(e){try{a(o.next(e))}catch(e){i(e)}}function c(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,c)}a((o=o.apply(e,t||[])).next())}))},n=this&&this.__rest||function(e,t){var r={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(o=Object.getOwnPropertySymbols(e);n<o.length;n++)t.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,o[n])&&(r[o[n]]=e[o[n]])}return r},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.cypherProjectionToGraph=void 0;const s=i(r(2)),c=r(3);t.cypherProjectionToGraph=function(e,t,r,i={},a={id:"@id",labels:"@labels",type:"@type"}){return o(this,void 0,void 0,(function*(){const o=new s.default({multi:!0,type:"directed",allowSelfLoops:!0}),p=e.driver.session({defaultAccessMode:c.session.READ,database:e.database});return yield new Promise(((e,r)=>{p.run(t,i).subscribe({onNext:e=>{e.has("id")||r(new Error("Node's query must return an `id` field"));const t=e.toObject(),{id:i,labels:s}=t,c=n(t,["id","labels"]),p=Object.assign(Object.assign({},c),{[a.id]:i,[a.labels]:s||[]});o.mergeNode(i,p)},onCompleted:()=>{e()},onError:e=>{p.close(),r(e)}})})),yield new Promise(((e,t)=>{p.run(r,i).subscribe({onNext:e=>{e.has("source")&&e.has("target")||t(new Error("Relationship's query must return an `source` & `target` field"));const r=e.toObject(),{source:i,target:s,id:c,type:p}=r,l=n(r,["source","target","id","type"]),u=c||`${i}->${s}`,y=Object.assign(Object.assign({},l),{[a.id]:u,[a.type]:p||""});o.mergeEdgeWithKey(u,i,s,y)},onCompleted:()=>{p.close(),e()},onError:e=>{p.close(),t(e)}})})),o}))}}],o={};function n(e){var t=o[e];if(void 0!==t)return t.exports;var i=o[e]={exports:{}};return r[e].call(i.exports,i,i.exports,n),i.exports}var i={};return(()=>{var e=i;Object.defineProperty(e,"__esModule",{value:!0}),e.cypherProjectionToGraph=e.cypherToGraph=void 0;const t=n(1);Object.defineProperty(e,"cypherToGraph",{enumerable:!0,get:function(){return t.cypherToGraph}});const r=n(4);Object.defineProperty(e,"cypherProjectionToGraph",{enumerable:!0,get:function(){return r.cypherProjectionToGraph}})})(),i})()}));
//# sourceMappingURL=graphology-neo4j.min.js.map